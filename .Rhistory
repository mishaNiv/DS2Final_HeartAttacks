# create row index; 80% split
tIndex <- sample(1:nrow(heart), 0.8*nrow(heart))
# use index to split intro train/test
trainD <- heart[tIndex, ]
testD <- heart[-tIndex, ]
heart.rf <- randomForest(as.factor(output) ~ ., data=trainD, importance=TRUE, proximity=TRUE)
confusionMatrix(data=predict(heart.rf, testD), reference=as.factor(testD$output))
# set seed
set.seed(1214)
# create row index; 80% split
tIndex <- sample(1:nrow(heart), 0.8*nrow(heart))
# use index to split intro train/test
trainD <- heart[tIndex, ]
testD <- heart[-tIndex, ]
heart.rf <- randomForest(as.factor(output) ~ ., data=trainD, importance=TRUE, proximity=TRUE)
confusionMatrix(data=predict(heart.rf, testD), reference=as.factor(testD$output))
# set seed
set.seed(0531)
# create row index; 80% split
tIndex <- sample(1:nrow(heart), 0.8*nrow(heart))
# use index to split intro train/test
trainD <- heart[tIndex, ]
testD <- heart[-tIndex, ]
heart.rf <- randomForest(as.factor(output) ~ ., data=trainD, importance=TRUE, proximity=TRUE)
confusionMatrix(data=predict(heart.rf, testD), reference=as.factor(testD$output))
# set seed
set.seed(825)
# create row index; 80% split
tIndex <- sample(1:nrow(heart), 0.8*nrow(heart))
# use index to split intro train/test
trainD <- heart[tIndex, ]
testD <- heart[-tIndex, ]
heart.rf <- randomForest(as.factor(output) ~ ., data=trainD, importance=TRUE, proximity=TRUE)
confusionMatrix(data=predict(heart.rf, testD), reference=as.factor(testD$output))
# set seed
set.seed(235)
# create row index; 80% split
tIndex <- sample(1:nrow(heart), 0.8*nrow(heart))
# use index to split intro train/test
trainD <- heart[tIndex, ]
testD <- heart[-tIndex, ]
heart.rf <- randomForest(as.factor(output) ~ ., data=trainD, importance=TRUE, proximity=TRUE)
confusionMatrix(data=predict(heart.rf, testD), reference=as.factor(testD$output))
# set seed
set.seed(904)
# create row index; 80% split
tIndex <- sample(1:nrow(heart), 0.8*nrow(heart))
# use index to split intro train/test
trainD <- heart[tIndex, ]
testD <- heart[-tIndex, ]
heart.rf <- randomForest(as.factor(output) ~ ., data=trainD, importance=TRUE, proximity=TRUE)
confusionMatrix(data=predict(heart.rf, testD), reference=as.factor(testD$output))
conf <- confusionMatrix(data=predict(heart.rf, testD), reference=as.factor(testD$output))
conf <- confusionMatrix(data=predict(heart.rf, testD), reference=as.factor(testD$output))
conf$overall
conf <- confusionMatrix(data=predict(heart.rf, testD), reference=as.factor(testD$output))
conf$positive
confusionMatrix(data=predict(heart.rf, testD), reference=as.factor(testD$output))
conf <- confusionMatrix(data=predict(heart.rf, testD), reference=as.factor(testD$output))
conf$table
conf$mode
conf$overall
conf$overall$Accuracy
conf$overall
conf$Accuracy
conf$overall['Accuracy']
mvar <- c(1:20)
nvar <- seq(50, 1000, 50)
bestmod <- heart.rf
bestval <- 0
for (val in mvar) {
for (val in nvar) {
newheart <- randomForest(as.factor(output) ~ ., data=trainD, importance=TRUE, proximity=TRUE)
conf <- confusionMatrix(data=predict(newheart, testD), reference=as.factor(testD$output))
if(conf$overall['Accuracy'] > bestval) {
bestmod <- newheart
bestval <- conf$overall['Accuracy']
}
}
}
mvar <- c(1:20)
nvar <- seq(50, 1000, 50)
bestmod <- heart.rf
bestval <- 0
for (val in mvar) {
mtry <- mvar
for (val in nvar) {
newheart <- randomForest(as.factor(output) ~ ., data=trainD, importance=TRUE, proximity=TRUE, mtry=mtry, ntrees=nvar)
conf <- confusionMatrix(data=predict(newheart, testD), reference=as.factor(testD$output))
if(conf$overall['Accuracy'] > bestval) {
bestmod <- newheart
bestval <- conf$overall['Accuracy']
}
}
}
mvar <- c(1:15)
nvar <- seq(50, 1000, 50)
bestmod <- heart.rf
bestval <- 0
for (val in mvar) {
mtry <- mvar
for (val in nvar) {
newheart <- randomForest(as.factor(output) ~ ., data=trainD, importance=TRUE, proximity=TRUE, mtry=mtry, ntrees=nvar)
conf <- confusionMatrix(data=predict(newheart, testD), reference=as.factor(testD$output))
if(conf$overall['Accuracy'] > bestval) {
bestmod <- newheart
bestval <- conf$overall['Accuracy']
}
}
}
newheart <- randomForest(as.factor(output) ~ ., data=trainD, importance=TRUE, proximity=TRUE, mtry=mtry, ntrees=nvar)
conf <- confusionMatrix(data=predict(newheart, testD), reference=as.factor(testD$output))
if(conf$overall['Accuracy'] > bestval) {
bestmod <- newheart
bestval <- conf$overall['Accuracy']
}
newheart <- randomForest(as.factor(output) ~ ., data=trainD, importance=TRUE, proximity=TRUE, mtry=mtry, ntrees=nvar)
conf <- confusionMatrix(data=predict(newheart, testD), reference=as.factor(testD$output))
newheart <- randomForest(as.factor(output) ~ ., data=trainD, importance=TRUE, proximity=TRUE, mtry=mtry, ntrees=nvar)
newheart <- randomForest(as.factor(output) ~ ., data=trainD, mtry=mtry, ntrees=nvar, importance=TRUE, proximity=TRUE)
newheart <- randomForest(as.factor(output) ~ ., data=trainD, mtry=8, ntrees=nvar, importance=TRUE, proximity=TRUE)
mvar <- c(1:20)
nvar <- seq(50, 1000, 50)
bestmod <- heart.rf
bestval <- 0
for (val in mvar) {
mvar1 <- mvar
for (val in nvar) {
newheart <- randomForest(as.factor(output) ~ ., data=trainD, importance=TRUE, proximity=TRUE, mtry=mvar1, ntrees=nvar)
conf <- confusionMatrix(data=predict(newheart, testD), reference=as.factor(testD$output))
if(conf$overall['Accuracy'] > bestval) {
bestmod <- newheart
bestval <- conf$overall['Accuracy']
}
}
}
newheart <- randomForest(as.factor(output) ~ ., data=trainD, importance=TRUE, proximity=TRUE, mtry=mvar1, ntrees=nvar)
conf <- confusionMatrix(data=predict(newheart, testD), reference=as.factor(testD$output))
if(conf$overall['Accuracy'] > bestval) {
bestmod <- newheart
bestval <- conf$overall['Accuracy']
}
newheart <- randomForest(as.factor(output) ~ ., data=trainD, importance=TRUE, proximity=TRUE, mtry=mvar1, ntrees=nvar)
conf <- confusionMatrix(data=predict(newheart, testD), reference=as.factor(testD$output))
newheart <- randomForest(as.factor(output) ~ ., data=trainD, importance=TRUE, proximity=TRUE, mtry=mvar1, ntrees=nvar)
mvar <- c(1:20)
nvar <- seq(50, 1000, 50)
bestmod <- heart.rf
bestval <- 0
for (val in mvar) {
mvar1 <- mvar[val]
for (val in nvar) {
newheart <- randomForest(as.factor(output) ~ ., data=trainD, importance=TRUE, proximity=TRUE, mtry=mvar1, ntrees=nvar)
conf <- confusionMatrix(data=predict(newheart, testD), reference=as.factor(testD$output))
if(conf$overall['Accuracy'] > bestval) {
bestmod <- newheart
bestval <- conf$overall['Accuracy']
}
}
}
mvar <- c(1:20)
nvar <- seq(50, 1000, 50)
bestmod <- heart.rf
bestval <- 0
for (val in mvar) {
mvar1 <- mvar[val]
for (val in nvar) {
newheart <- randomForest(as.factor(output) ~ ., data=trainD, importance=TRUE, proximity=TRUE, mtry=mvar1, ntrees=nvar)
conf <- confusionMatrix(data=predict(newheart, testD), reference=as.factor(testD$output))
if(conf$overall['Accuracy'] > bestval) {
bestmod <- newheart
bestval <- conf$overall['Accuracy']
}
}
}
mvar <- c(1:13)
nvar <- seq(50, 1000, 50)
bestmod <- heart.rf
bestval <- 0
for (val in mvar) {
mvar1 <- mvar[val]
for (val in nvar) {
newheart <- randomForest(as.factor(output) ~ ., data=trainD, importance=TRUE, proximity=TRUE, mtry=mvar1, ntrees=nvar)
conf <- confusionMatrix(data=predict(newheart, testD), reference=as.factor(testD$output))
if(conf$overall['Accuracy'] > bestval) {
bestmod <- newheart
bestval <- conf$overall['Accuracy']
}
}
}
bestmod
bestval
conf <- confusionMatrix(data=predict(heart.rf, testD), reference=as.factor(testD$output))
confusionMatrix(data=predict(heart.rf, testD), reference=as.factor(testD$output))
conf <- confusionMatrix(data=predict(bestmod, testD), reference=as.factor(testD$output))
confusionMatrix(data=predict(bestmod, testD), reference=as.factor(testD$output))
head(heart)
view(heart)
summary(heart)
library(caret)
library(corrplot)
corrplot(cor(heart), method = "color",
title = "method = 'color'",
tl.pos = "n", mar = c(2, 1, 3, 1))
corrplot(cor(heart), method = "color",
title = "method = 'color'",
col=colorRampPalette(c("white","lightblue","red")),
tl.pos = "n", mar = c(2, 1, 3, 1))
corrplot(cor(heart), method = "color",
title = "method = 'color'",
col = colorRampPalette(c("white","lightblue","red"))(100),
tl.pos = "n", mar = c(2, 1, 3, 1))
corrplot(cor(heart), method = "color",
title = "method = 'color'",
col = colorRampPalette(c("white","lightblue","lightpurple")
(100),
tl.pos = "n", mar = c(2, 1, 3, 1))
corrplot(cor(heart), method = "color",
title = "method = 'color'",
col = colorRampPalette(c("white","lightblue","lightpurple"))(100),
tl.pos = "n", mar = c(2, 1, 3, 1))
corrplot(cor(heart), method = "color",
title = "method = 'color'",
col = colorRampPalette(c("white","lightblue","orchid"))(100),
tl.pos = "n", mar = c(2, 1, 3, 1))
corrplot(cor(heart), method = "color",
title = "method = 'color'",
col = colorRampPalette(c("white","skyblue","palered"))(100),
tl.pos = "n", mar = c(2, 1, 3, 1))
corrplot(cor(heart), method = "color",
title = "method = 'color'",
col = colorRampPalette(c("white","skyblue","salmon"))(100),
tl.pos = "n", mar = c(2, 1, 3, 1))
corrplot(cor(heart), method = "color",
title = "method = 'color'",
col = colorRampPalette(c("white","lightblue","salmon"))(100),
tl.pos = "n", mar = c(2, 1, 3, 1))
corrplot(cor(heart), method = "color",
title = "method = 'color'",
col = colorRampPalette(c("lightblue","salmon","red"))(100),
tl.pos = "n", mar = c(2, 1, 3, 1))
corrplot(cor(heart), method = "color",
title = "method = 'color'",
col = colorRampPalette(c("white","mintgreen","red"))(100),
tl.pos = "n", mar = c(2, 1, 3, 1))
corrplot(cor(heart), method = "color",
title = "method = 'color'",
col = colorRampPalette(c("white","darkseagreen1","red"))(100),
tl.pos = "n", mar = c(2, 1, 3, 1))
corrplot(cor(heart), method = "color",
title = "method = 'color'",
col = colorRampPalette(c("white","darkseagreen1","brown2"))(100),
tl.pos = "n", mar = c(2, 1, 3, 1))
corrplot(cor(heart), method = "color",
title = "method = 'color'",
col = colorRampPalette(c("white","darkolivegreen2","brown2"))(100),
tl.pos = "n", mar = c(2, 1, 3, 1))
corrplot(cor(heart), method = "color",
title = "method = 'color'",
col = colorRampPalette(c("white","lightsalmon","brown2"))(100),
tl.pos = "n", mar = c(2, 1, 3, 1))
corrplot(cor(heart), method = "color",
title = "method = 'color'",
col = colorRampPalette(c("white","orange","brown2"))(100),
tl.pos = "n", mar = c(2, 1, 3, 1))
corrplot(cor(heart), method = "color",
title = "method = 'color'",
col = colorRampPalette(c("orange","white","brown2"))(100),
tl.pos = "n", mar = c(2, 1, 3, 1))
corrplot(cor(heart), method = "color",
title = "method = 'color'",
col = colorRampPalette(c("orange","coral","brown2"))(100),
tl.pos = "n", mar = c(2, 1, 3, 1))
corrplot(cor(heart), method = "color",
title = "method = 'color'",
col = colorRampPalette(c("antiquewhite","coral","brown2"))(100),
tl.pos = "n", mar = c(2, 1, 3, 1))
corrplot(cor(heart), method = "color",
title = "method = 'color'",
col = colorRampPalette(c("white","coral","brown2"))(100),
tl.pos = "n", mar = c(2, 1, 3, 1))
corrplot(cor(heart), method = "color",
title = "method = 'color'",
col = colorRampPalette(c("white","gold","brown2"))(100),
tl.pos = "n", mar = c(2, 1, 3, 1))
corrplot(cor(heart), method = "color",
title = "method = 'color'",
col = colorRampPalette(c("purple","gold","brown2"))(100),
tl.pos = "n", mar = c(2, 1, 3, 1))
corrplot(cor(heart), method = "color",
title = "method = 'color'",
col = colorRampPalette(c("purple","darkorchid","brown2"))(100),
tl.pos = "n", mar = c(2, 1, 3, 1))
corrplot(cor(heart), method = "color",
title = "method = 'color'",
col = colorRampPalette(c("purple","salmon","brown2"))(100),
tl.pos = "n", mar = c(2, 1, 3, 1))
corrplot(cor(heart), method = "color",
title = "method = 'color'",
col = colorRampPalette(c("lavender","salmon","brown2"))(100),
tl.pos = "n", mar = c(2, 1, 3, 1))
corrplot(cor(heart), method = "color",
title = "method = 'color'",
col = colorRampPalette(c("white","mediumpurple1","brown2"))(100),
tl.pos = "n", mar = c(2, 1, 3, 1))
corrplot(cor(heart), method = "color",
title = "method = 'color'",
col = colorRampPalette(c("white","salmon","brown2"))(100),
tl.pos = "n", mar = c(2, 1, 3, 1))
corrplot(cor(heart), method = "color",
title = "method = 'color'",
col = colorRampPalette(c("white","lightsalmon","brown2"))(100),
tl.pos = "n", mar = c(2, 1, 3, 1))
corrplot(cor(heart), method = "color",
title = "method = 'color'",
col = colorRampPalette(c("white","rosybrown1","brown2"))(100),
tl.pos = "n", mar = c(2, 1, 3, 1))
corrplot(cor(heart), method = "color",
title = "method = 'color'",
col = colorRampPalette(c("white","pink1","brown2"))(100),
tl.pos = "n", mar = c(2, 1, 3, 1))
corrplot(cor(heart), method = "color",
title = "method = 'color'",
col = colorRampPalette(c("white","palevioletred1","brown2"))(100),
tl.pos = "n", mar = c(2, 1, 3, 1))
corrplot(cor(heart), method = "color",
title = "method = 'color'",
col = colorRampPalette(c("white","lightsalmon","brown2"))(100),
tl.pos = "n", mar = c(2, 1, 3, 1))
corrplot(cor(heart), method = "color",
title = "Correlation of Heart Data",
col = colorRampPalette(c("white","lightsalmon","brown2"))(100),
tl.pos = "n", mar = c(2, 1, 3, 1))
corrplot(cor(heart), method = "shade",
title = "Correlation of Heart Data",
col = colorRampPalette(c("white","lightsalmon","brown2"))(100),
tl.pos = "n", mar = c(2, 1, 3, 1),
lavels)
corrplot(cor(heart), method = "color",
title = "Correlation of Heart Data",
col = colorRampPalette(c("white","lightsalmon","brown2"))(100),
tl.pos = "n", mar = c(2, 1, 3, 1),
lavels)
corrplot(cor(heart), method = "color",
title = "Correlation of Heart Data",
col = colorRampPalette(c("white","lightsalmon","brown2"))(100),
tl.pos = "n", mar = c(2, 1, 3, 1),
)
corrplot(cor(heart), method = "shade",
title = "Correlation of Heart Data",
col = colorRampPalette(c("white","lightsalmon","brown2"))(100),
tl.pos = "n", mar = c(2, 1, 3, 1),
)
corrplot(cor(heart), method = "shade",
title = "Correlation of Heart Data",
col = colorRampPalette(c("white","lightsalmon","brown2"))(100),
tl.pos = "n", mar = c(2, 1, 3, 1),
type=full
)
corrplot(cor(heart), method = "shade",
title = "Correlation of Heart Data",
col = colorRampPalette(c("white","lightsalmon","brown2"))(100),
tl.pos = "n", mar = c(2, 1, 3, 1),
type="full"
)
corrplot(cor(heart), method = "shade",
title = "Correlation of Heart Data",
col = colorRampPalette(c("white","lightsalmon","brown2"))(100),
tl.pos = "n", mar = c(2, 1, 3, 1),
tl.col="black"
)
corrplot(cor(heart), method = "shade",
title = "Correlation of Heart Data",
col = colorRampPalette(c("white","lightsalmon","brown2"))(100),
tl.pos = "n", mar = c(2, 1, 3, 1),
bg="black"
)
corrplot.mixed(cor(heart),
title = "Correlation of Heart Data",
lower = "color",
upper = "color",
col = colorRampPalette(c("white","lightsalmon","brown2"))(100),
)
corrplot.mixed(cor(heart),
title = "Correlation of Heart Data",
lower = "color",
upper = "color",
diag = FALSE,
col = colorRampPalette(c("white","lightsalmon","brown2"))(100),
)
corrplot.mixed(cor(heart),
title = "Correlation of Heart Data",
lower = "color",
upper = "color",
diag = FALSE,
col = colorRampPalette(c("white","lightsalmon","brown2"))(100)
)
corrplot(cor(heart), method = "shade",
title = "Correlation of Heart Data",
col = colorRampPalette(c("white","lightsalmon","brown2"))(100),
tl.pos = "n", mar = c(2, 1, 3, 1),
diag = FALSE
)
corrplot(cor(heart), method = "shade",
title = "Correlation of Heart Data",
col = colorRampPalette(c("white","lightsalmon","brown2"))(100),
tl.pos = "n", mar = c(2, 1, 3, 1),
)
cor(heart)
corrplot(cor(heart), method = "shade",
title = "Correlation of Heart Data",
col = colorRampPalette(c("white","lightsalmon","brown2"))(100),
tl.pos = "lt",
mar = c(2, 1, 3, 1),
)
corrplot(cor(heart), method = "shade",
title = "Correlation of Heart Data",
col = colorRampPalette(c("white","lightsalmon","brown2"))(100),
tl.pos = "d",
mar = c(2, 1, 3, 1),
)
corrplot(cor(heart), method = "shade",
title = "Correlation of Heart Data",
col = colorRampPalette(c("white","lightsalmon","brown2"))(100),
tl.pos = "lt",
mar = c(2, 1, 3, 1),
)
corrplot(cor(heart), method = "shade",
title = "Correlation of Heart Data",
col = colorRampPalette(c("white","lightsalmon","brown2"))(100),
tl.pos = "lb",
mar = c(2, 1, 3, 1),
)
corrplot(cor(heart), method = "shade",
title = "Correlation of Heart Data",
col = colorRampPalette(c("white","lightsalmon","brown2"))(100),
tl.pos = "lt",
mar = c(2, 1, 3, 1),
)
corrplot(cor(heart), method = "shade",
title = "Correlation of Heart Data",
col = colorRampPalette(c("white","lightsalmon","brown2"))(100),
tl.pos = "l",
mar = c(2, 1, 3, 1),
)
corrplot(cor(heart), method = "shade",
title = "Correlation of Heart Data",
col = colorRampPalette(c("white","lightsalmon","brown2"))(100),
tl.pos = "l",
mar = c(2, 1, 3, 1),
tl.cex = 1
)
corrplot(cor(heart), method = "shade",
title = "Correlation of Heart Data",
col = colorRampPalette(c("white","lightsalmon","brown2"))(100),
tl.pos = "l",
mar = c(2, 1, 3, 1),
tl.cex = 2
)
corrplot(cor(heart), method = "shade",
title = "Correlation of Heart Data",
col = colorRampPalette(c("white","lightsalmon","brown2"))(100),
tl.pos = "l",
mar = c(2, 1, 3, 1),
tl.cex = 0.5
)
corrplot(cor(heart), method = "shade",
title = "Correlation of Heart Data",
col = colorRampPalette(c("white","lightsalmon","brown2"))(100),
tl.pos = "l",
mar = c(2, 1, 3, 1),
tl.cex = 0.75
)
corrplot(cor(heart), method = "shade",
title = "Correlation of Heart Data",
col = colorRampPalette(c("white","lightsalmon","brown2"))(100),
tl.pos = "l",
mar = c(2, 1, 3, 1),
tl.cex = 0.75
tl.col = "brown4"
corrplot(cor(heart), method = "shade",
title = "Correlation of Heart Data",
col = colorRampPalette(c("white","lightsalmon","brown2"))(100),
tl.pos = "l",
mar = c(2, 1, 3, 1),
tl.cex = 0.75,
tl.col = "brown4"
)
corrplot(cor(heart), method = "shade",
title = "Correlation of Heart Data",
col = colorRampPalette(c("white","lightsalmon","brown2"))(100),
tl.pos = "l",
mar = c(2, 1, 3, 1),
tl.cex = 0.75,
tl.col = "darkred"
)
source("C:/Users/mnivota/OneDrive - Eastside Preparatory School/12th Grade/Data Sci 2/Final/DS2Final_HeartAttacks/app.R", echo=TRUE)
runApp()
library(caret)
library(corrplot)
heart <- read.csv("heart.csv")
heart
summary(heart)
corrplot(cor(heart), method = "shade",
title = "Correlation of Heart Data",
col = colorRampPalette(c("white","lightsalmon","brown2"))(100),
tl.pos = "l",
mar = c(2, 1, 3, 1),
tl.cex = 0.75,
tl.col = "darkred"
)
runApp()
